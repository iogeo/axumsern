<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
          "http://www.w3.org/TR/html4/loose.dtd">
<head>
    <script src='ffmpeg.min.js'></script>
</head>
<body>
    <video width="640" height="480" id="wq" loop></video>
    <canvas id="canvas" width="640" height="480"></canvas>
    <p>Log in as User <input type="text" id=userid></input> <button id=user>Log in</button> </p>
    <script>
        var rppq = "mousedown";
        var streamrq;
        var ws;
        var wq = document.getElementById("wq");
        var q = "";
        const canvas = document.getElementById('canvas');
        const userid = document.getElementById('userid');
        const user = document.getElementById('user');
        const ctx = canvas.getContext('2d');
        async function sock2(l) {
            ws.removeEventListener("message", sockw2);
            ws.addEventListener("message", sockw);
            ws.send(streamrq);
            ws.send("cs");
            ws.send(streamrq);
            ws.send("waiting");
            ws.removeEventListener("open", sock2);
        }
        async function sockw2(l) {
            q = l.data;
            var rqw = 0;
            while (q[rqw] != "\n")
            {
                rqw += 1;
            }
            rqw += 1;
            while (rqw < q.length)
            {
                var rp = "";
                var rp2 = "";
                while (q[rqw] != ",")
                {
                    rp += q[rqw];
                    rqw += 1;
                }
                rq.push(rp);
                while (q[rqw] != "\n")
                {
                    rp2 += q[rqw];
                    rqw += 1;
                }
                rw.push(rp2);
                rqw += 1;
            }
        }
        function eqw(l) {
            ws = new WebSocket("wss://qw.bhuman.ai/qw");
            ws.addEventListener("open", sock2);
            streamrq = userid.value;
            ws.addEventListener("message", sockw2);
        }
        async function sock2(l) {
            ws.send(streamrq);
            ws.send("waiting");
            ws.removeEventListener("open", sock2);
        }
        async function sockw(l) {
            q = l.data;
            var ul = URL.createObjectURL(new Blob([q], { type: 'video/mp4' }));
            wq.src = ul;
            wq.play();
        }
        user.addEventListener(rppq, eqw);
    </script>
</body>
</html>
